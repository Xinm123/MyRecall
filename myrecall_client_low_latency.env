# OpenRecall Client Configuration

# ==============================================================================
# Connection Settings
# ==============================================================================
# The URL of the OpenRecall server API
# Ensure the port matches OPENRECALL_PORT in the server config (default 18083)
OPENRECALL_API_URL=http://localhost:28083/api

# Upload timeout in seconds (increase if server is slow processing)
OPENRECALL_UPLOAD_TIMEOUT=180

# ==============================================================================
# Data Directory Settings
# ==============================================================================
# Server Data Directory (Default: ~/MRS)
OPENRECALL_SERVER_DATA_DIR=~/testvad/MRS
# Client Data Directory (Default: ~/MRC)
OPENRECALL_CLIENT_DATA_DIR=~/testvad/MRC
# ==============================================================================
# Capture Settings
# ==============================================================================
# Screenshot capture interval in seconds
OPENRECALL_CAPTURE_INTERVAL=20

# Only capture the primary monitor (set to false to capture all monitors)
OPENRECALL_PRIMARY_MONITOR_ONLY=true

# Disable similarity-based deduplication (set to true to capture every cycle)
OPENRECALL_DISABLE_SIMILARITY_FILTER=false

# Similarity threshold (0.0-1.0). Higher values capture more (images considered similar when score >= threshold)
OPENRECALL_SIMILARITY_THRESHOLD=0.9

# Video chunk duration in seconds (default now 60s = 1 minute).
# Source of truth: client-side recording uses this value.
OPENRECALL_VIDEO_CHUNK_DURATION=60

# ==============================================================================
# Video Monitor Pipeline (Phase 1 hardening)
# ==============================================================================
# Comma-separated monitor IDs to capture (empty = auto select by OPENRECALL_PRIMARY_MONITOR_ONLY)
OPENRECALL_VIDEO_MONITOR_IDS=

# Restart per-monitor pipeline immediately if pixel format/resolution/color-range changes
OPENRECALL_VIDEO_PIPELINE_RESTART_ON_PROFILE_CHANGE=true

# Max persistent frame buffer size per monitor (bytes)
OPENRECALL_VIDEO_POOL_MAX_BYTES=67108864

# Stagger startup for multi-monitor pipelines to reduce simultaneous segment I/O burst
OPENRECALL_VIDEO_SEGMENT_STAGGER_SECONDS=2

# Warn when single frame write to ffmpeg stdin is slower than this threshold (ms)
OPENRECALL_VIDEO_PIPE_WRITE_WARN_MS=50

# Video pipeline mode: segment | chunk_process
# chunk_process = strict wallclock chunking (60s target) + internal grace-based self-heal.
OPENRECALL_VIDEO_PIPELINE_MODE=chunk_process

# Timeout for single ffmpeg stdin write in ms
OPENRECALL_VIDEO_PIPE_WRITE_TIMEOUT_MS=1500

# Segment mode only: restart if chunk boundary has no progress for this many seconds
# chunk_process uses internal deadline+grace watchdog (no extra env key required).
OPENRECALL_VIDEO_NO_CHUNK_PROGRESS_TIMEOUT_SECONDS=180

# Raw input color range policy: auto | tv | pc
OPENRECALL_VIDEO_COLOR_RANGE=auto

# SCK startup retries before fallback to legacy mode
OPENRECALL_SCK_START_RETRY_MAX=3

# Backoff between normal SCK retries (seconds)
OPENRECALL_SCK_RETRY_BACKOFF_SECONDS=2

# Backoff after permission_denied errors (seconds)
OPENRECALL_SCK_PERMISSION_BACKOFF_SECONDS=30

# Probe interval to recover from legacy fallback back to SCK mode (seconds)
OPENRECALL_SCK_RECOVERY_PROBE_SECONDS=5

# Whether legacy mode should auto-probe and recover to SCK when available
OPENRECALL_SCK_AUTO_RECOVER_FROM_LEGACY=true

# ==============================================================================
# Debug & Storage
# ==============================================================================
# Enable debug logging
OPENRECALL_DEBUG=true

# Save screenshots locally on the client as well (useful for debugging or backup)
# OPENRECALL_CLIENT_SAVE_LOCAL_SCREENSHOTS=false

# ==============================================================================
# Low-Latency Overrides (Coding + Keyboard Noise)
# ==============================================================================
# Shorter audio chunks for lower end-to-end delay.
OPENRECALL_AUDIO_CHUNK_DURATION=20

# Keep logs concise for long-running dev sessions.
OPENRECALL_DEBUG=false
