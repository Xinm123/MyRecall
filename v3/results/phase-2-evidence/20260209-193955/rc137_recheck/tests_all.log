============================= test session starts ==============================
platform darwin -- Python 3.11.14, pytest-9.0.2, pluggy-1.6.0 -- /opt/homebrew/Caskroom/miniforge/base/envs/v3/bin/python3
cachedir: .pytest_cache
rootdir: /Users/pyw/new/MyRecall
configfile: pytest.ini
plugins: anyio-4.12.1
collecting ... collected 520 items / 22 deselected / 498 selected

tests/test_ai_provider_openai_embedding_ocr.py::test_openai_embedding_provider_builds_embeddings_request PASSED [  0%]
tests/test_ai_provider_openai_embedding_ocr.py::test_openai_ocr_provider_builds_chat_completions_request PASSED [  0%]
tests/test_api_config_validation.py::test_get_config_includes_client_online PASSED [  0%]
tests/test_api_config_validation.py::test_update_config_rejects_unknown_field PASSED [  0%]
tests/test_api_config_validation.py::test_update_config_rejects_non_boolean PASSED [  1%]
tests/test_nlp.py::test_cosine_similarity_identical_vectors PASSED       [  1%]
tests/test_nlp.py::test_cosine_similarity_orthogonal_vectors PASSED      [  1%]
tests/test_nlp.py::test_cosine_similarity_opposite_vectors PASSED        [  1%]
tests/test_nlp.py::test_cosine_similarity_non_unit_vectors PASSED        [  1%]
tests/test_nlp.py::test_cosine_similarity_arbitrary_vectors PASSED       [  2%]
tests/test_nlp.py::test_cosine_similarity_zero_vector PASSED             [  2%]
tests/test_nlp_engine_mocked.py::test_nlp_engine_encode_empty_text_returns_zero PASSED [  2%]
tests/test_nlp_engine_mocked.py::test_nlp_engine_encode_success PASSED   [  2%]
tests/test_nlp_engine_mocked.py::test_nlp_engine_encode_exception_returns_zero PASSED [  2%]
tests/test_nlp_engine_mocked.py::test_get_nlp_engine_caches_instance PASSED [  3%]
tests/test_nlp_engine_mocked.py::test_get_embedding_uses_singleton PASSED [  3%]
tests/test_phase0_api_v1.py::TestV1Health::test_v1_health PASSED         [  3%]
tests/test_phase0_api_v1.py::TestV1Health::test_legacy_health PASSED     [  3%]
tests/test_phase0_api_v1.py::TestV1MemoriesRecent::test_paginated_envelope PASSED [  3%]
tests/test_phase0_api_v1.py::TestV1MemoriesRecent::test_default_pagination PASSED [  4%]
tests/test_phase0_api_v1.py::TestV1MemoriesLatest::test_paginated_envelope PASSED [  4%]
tests/test_phase0_api_v1.py::TestV1MemoriesLatest::test_invalid_since PASSED [  4%]
tests/test_phase0_api_v1.py::TestV1Search::test_search_paginated PASSED  [  4%]
tests/test_phase0_api_v1.py::TestV1Search::test_empty_query PASSED       [  4%]
tests/test_phase0_api_v1.py::TestV1Upload::test_upload PASSED            [  5%]
tests/test_phase0_api_v1.py::TestV1Upload::test_upload_no_file PASSED    [  5%]
tests/test_phase0_api_v1.py::TestV1Config::test_get_config PASSED        [  5%]
tests/test_phase0_api_v1.py::TestV1Config::test_post_config PASSED       [  5%]
tests/test_phase0_api_v1.py::TestV1Heartbeat::test_heartbeat PASSED      [  5%]
tests/test_phase0_api_v1.py::TestV1QueueStatus::test_queue_status PASSED [  6%]
tests/test_phase0_api_v1.py::TestAuthDecorator::test_all_v1_routes_have_auth PASSED [  6%]
tests/test_phase0_backward_compat.py::TestFullV2Pipeline::test_upload_query_after_migration PASSED [  6%]
tests/test_phase0_backward_compat.py::TestLegacyApiUntouched::test_all_legacy_endpoints PASSED [  6%]
tests/test_phase0_backward_compat.py::TestV1AndLegacyCoexist::test_both_health_endpoints PASSED [  6%]
tests/test_phase0_backward_compat.py::TestQueryOverhead::test_query_overhead_under_10ms PASSED [  7%]
tests/test_phase0_config_matrix.py::TestDeploymentMode::test_local_defaults PASSED [  7%]
tests/test_phase0_config_matrix.py::TestDeploymentMode::test_no_mode_defaults_to_local PASSED [  7%]
tests/test_phase0_config_matrix.py::TestDeploymentMode::test_deployment_mode_set_via_env PASSED [  7%]
tests/test_phase0_config_matrix.py::TestConfigPresets::test_get_preset_local PASSED [  7%]
tests/test_phase0_config_matrix.py::TestConfigPresets::test_get_preset_debian_server PASSED [  8%]
tests/test_phase0_config_matrix.py::TestConfigPresets::test_get_preset_debian_client PASSED [  8%]
tests/test_phase0_config_matrix.py::TestConfigPresets::test_get_preset_remote PASSED [  8%]
tests/test_phase0_config_matrix.py::TestConfigPresets::test_invalid_mode_raises PASSED [  8%]
tests/test_phase0_config_matrix.py::TestConfigPresets::test_all_four_modes_defined PASSED [  8%]
tests/test_phase0_config_matrix.py::TestEnvTemplates::test_all_env_files_exist PASSED [  9%]
tests/test_phase0_config_matrix.py::TestEnvTemplates::test_env_files_contain_deployment_mode PASSED [  9%]
tests/test_phase0_config_matrix.py::TestEnvTemplates::test_debian_server_binds_all PASSED [  9%]
tests/test_phase0_gates.py::TestGateF01Schema–úigrationSuccess::test_gate_F01_schema_migration_success PASSED [  9%]
tests/test_phase0_gates.py::TestGateF02BackwardCompatibility::test_gate_F02_backward_compatibility PASSED [  9%]
tests/test_phase0_gates.py::TestGateF03ApiVersioning::test_gate_F03_api_versioning PASSED [ 10%]
tests/test_phase0_gates.py::TestGateF04ConfigurationMatrix::test_gate_F04_configuration_matrix PASSED [ 10%]
tests/test_phase0_gates.py::TestGateP01MigrationLatency::test_gate_P01_migration_latency PASSED [ 10%]
tests/test_phase0_gates.py::TestGateP02QueryOverhead::test_gate_P02_query_overhead PASSED [ 10%]
tests/test_phase0_gates.py::TestGateS01DataIntegrity::test_gate_S01_data_integrity PASSED [ 10%]
tests/test_phase0_gates.py::TestGateS02RollbackSuccess::test_gate_S02_rollback_success PASSED [ 11%]
tests/test_phase0_gates.py::TestGateR01MigrationMemory::test_gate_R01_migration_memory PASSED [ 11%]
tests/test_phase0_gates.py::TestGateR02SchemaOverhead::test_gate_R02_schema_overhead PASSED [ 11%]
tests/test_phase0_gates.py::TestGateDG01PiiClassificationPolicy::test_gate_DG01_pii_classification_policy PASSED [ 11%]
tests/test_phase0_gates.py::TestGateDG02EncryptionSchema::test_gate_DG02_encryption_schema PASSED [ 11%]
tests/test_phase0_gates.py::TestGateDG03RetentionPolicy::test_gate_DG03_retention_policy PASSED [ 12%]
tests/test_phase0_gates.py::TestGateDG04AuthPlaceholder::test_gate_DG04_auth_placeholder PASSED [ 12%]
tests/test_phase0_gates.py::TestGateUQ01BufferCapacity::test_gate_UQ01_buffer_capacity PASSED [ 12%]
tests/test_phase0_gates.py::TestGateUQ02TTLCleanup::test_gate_UQ02_ttl_cleanup PASSED [ 12%]
tests/test_phase0_gates.py::TestGateUQ03FifoDeletion::test_gate_UQ03_fifo_deletion PASSED [ 12%]
tests/test_phase0_gates.py::TestGateUQ04PostUploadDeletion::test_gate_UQ04_post_upload_deletion PASSED [ 13%]
tests/test_phase0_gates.py::TestGateUQ05RetryBackoff::test_gate_UQ05_retry_backoff PASSED [ 13%]
tests/test_phase0_migration.py::TestMigrationForward::test_migration_creates_all_tables PASSED [ 13%]
tests/test_phase0_migration.py::TestMigrationForward::test_migration_idempotent PASSED [ 13%]
tests/test_phase0_migration.py::TestMigrationForward::test_migration_preserves_entries PASSED [ 13%]
tests/test_phase0_migration.py::TestMigrationForward::test_migration_performance_10k PASSED [ 14%]
tests/test_phase0_migration.py::TestMigrationForward::test_migration_memory_under_500mb PASSED [ 14%]
tests/test_phase0_migration.py::TestMigrationForward::test_schema_overhead_under_10mb PASSED [ 14%]
tests/test_phase0_migration.py::TestGovernanceColumns::test_governance_columns_exist PASSED [ 14%]
tests/test_phase0_migration.py::TestGovernanceColumns::test_encryption_columns_exist PASSED [ 14%]
tests/test_phase0_migration.py::TestGovernanceColumns::test_created_at_backfill PASSED [ 15%]
tests/test_phase0_migration.py::TestRollback::test_rollback_restores_original PASSED [ 15%]
tests/test_phase0_migration.py::TestRollback::test_rollback_preserves_entry_count PASSED [ 15%]
tests/test_phase0_migration.py::TestRollback::test_rollback_removes_governance_columns PASSED [ 15%]
tests/test_phase0_migration.py::TestRollback::test_rollback_completes_under_2min PASSED [ 15%]
tests/test_phase0_migration.py::TestIntegrity::test_data_integrity_checksum PASSED [ 16%]
tests/test_phase0_migration.py::TestIntegrity::test_checksum_deterministic PASSED [ 16%]
tests/test_phase0_models.py::TestVideoChunk::test_creation_with_defaults PASSED [ 16%]
tests/test_phase0_models.py::TestVideoChunk::test_creation_with_all_fields PASSED [ 16%]
tests/test_phase0_models.py::TestFrame::test_creation_with_required_fields PASSED [ 16%]
tests/test_phase0_models.py::TestFrame::test_creation_with_all_fields PASSED [ 17%]
tests/test_phase0_models.py::TestOcrText::test_creation PASSED           [ 17%]
tests/test_phase0_models.py::TestOcrText::test_with_optional_fields PASSED [ 17%]
tests/test_phase0_models.py::TestAudioChunk::test_creation_with_defaults PASSED [ 17%]
tests/test_phase0_models.py::TestAudioChunk::test_creation_with_all_fields PASSED [ 17%]
tests/test_phase0_models.py::TestAudioTranscription::test_nullable_speaker_id PASSED [ 18%]
tests/test_phase0_models.py::TestAudioTranscription::test_with_speaker_id PASSED [ 18%]
tests/test_phase0_models.py::TestPaginatedResponse::test_generic_with_video_chunk PASSED [ 18%]
tests/test_phase0_models.py::TestPaginatedResponse::test_has_more_false PASSED [ 18%]
tests/test_phase0_models.py::TestPaginatedResponse::test_serialization PASSED [ 18%]
tests/test_phase0_models.py::TestRecallEntryUnchanged::test_recall_entry_still_works PASSED [ 19%]
tests/test_phase0_upload_queue.py::TestCapacityEnforcement::test_capacity_enforcement_fifo PASSED [ 19%]
tests/test_phase0_upload_queue.py::TestCapacityEnforcement::test_fifo_deletion_order PASSED [ 19%]
tests/test_phase0_upload_queue.py::TestTTLCleanup::test_ttl_cleanup_7_days PASSED [ 19%]
tests/test_phase0_upload_queue.py::TestPostUploadDeletion::test_post_upload_deletion_timing PASSED [ 19%]
tests/test_phase0_upload_queue.py::TestExponentialBackoff::test_backoff_schedule PASSED [ 20%]
tests/test_phase0_upload_queue.py::TestExponentialBackoff::test_backoff_caps_at_max PASSED [ 20%]
tests/test_phase0_upload_queue.py::TestExponentialBackoff::test_consumer_uses_adr0002_backoff PASSED [ 20%]
tests/test_phase1_5_focused_browser_url.py::TestInsertFrameFocusedBrowserUrl::test_insert_frame_focused_true_stores_1 PASSED [ 20%]
tests/test_phase1_5_focused_browser_url.py::TestInsertFrameFocusedBrowserUrl::test_insert_frame_focused_none_stores_null PASSED [ 20%]
tests/test_phase1_5_focused_browser_url.py::TestInsertFrameFocusedBrowserUrl::test_insert_frame_browser_url_stored PASSED [ 21%]
tests/test_phase1_5_focused_browser_url.py::TestInsertFrameFocusedBrowserUrl::test_insert_frame_browser_url_none_stores_null PASSED [ 21%]
tests/test_phase1_5_focused_browser_url.py::TestQueryReturnsFocusedBrowserUrl::test_query_frames_returns_focused_browser_url PASSED [ 21%]
tests/test_phase1_5_focused_browser_url.py::TestQueryReturnsFocusedBrowserUrl::test_query_frames_normalizes_null_focused PASSED [ 21%]
tests/test_phase1_5_focused_browser_url.py::TestQueryReturnsFocusedBrowserUrl::test_search_video_fts_returns_focused_browser_url PASSED [ 21%]
tests/test_phase1_5_focused_browser_url.py::TestTimelineAPIFocusedBrowserUrl::test_timeline_response_includes_focused_and_browser_url PASSED [ 22%]
tests/test_phase1_5_focused_browser_url.py::TestSearchAPIFocusedBrowserUrlCompatibility::test_search_video_result_includes_focused_browser_url PASSED [ 22%]
tests/test_phase1_5_focused_browser_url.py::TestSearchAPIFocusedBrowserUrlCompatibility::test_search_snapshot_result_keeps_old_shape_plus_null_optionals PASSED [ 22%]
tests/test_phase1_5_metadata_resolver.py::TestResolveFrameMetadata::test_frame_level_beats_chunk_level_app_name PASSED [ 22%]
tests/test_phase1_5_metadata_resolver.py::TestResolveFrameMetadata::test_frame_level_beats_chunk_level_window_name PASSED [ 22%]
tests/test_phase1_5_metadata_resolver.py::TestResolveFrameMetadata::test_chunk_level_used_when_frame_level_empty PASSED [ 23%]
tests/test_phase1_5_metadata_resolver.py::TestResolveFrameMetadata::test_returns_none_when_both_empty PASSED [ 23%]
tests/test_phase1_5_metadata_resolver.py::TestResolveFrameMetadata::test_empty_string_treated_as_missing PASSED [ 23%]
tests/test_phase1_5_metadata_resolver.py::TestResolveFrameMetadata::test_focused_none_when_not_provided PASSED [ 23%]
tests/test_phase1_5_metadata_resolver.py::TestResolveFrameMetadata::test_focused_true_false_from_bool_and_int PASSED [ 23%]
tests/test_phase1_5_metadata_resolver.py::TestResolveFrameMetadata::test_focused_chunk_fallback_when_frame_missing PASSED [ 24%]
tests/test_phase1_5_metadata_resolver.py::TestResolveFrameMetadata::test_browser_url_frame_then_chunk_fallback PASSED [ 24%]
tests/test_phase1_5_metadata_resolver.py::TestResolveFrameMetadata::test_source_field_correct PASSED [ 24%]
tests/test_phase1_5_metadata_resolver.py::TestResolveFrameMetadata::test_both_inputs_none_returns_all_none PASSED [ 24%]
tests/test_phase1_5_metadata_resolver.py::TestResolveFrameMetadata::test_whitespace_only_strings_treated_as_missing PASSED [ 24%]
tests/test_phase1_5_ocr_engine.py::TestOCREngineName::test_mock_ocr_engine_name_stored PASSED [ 25%]
tests/test_phase1_5_ocr_engine.py::TestOCREngineName::test_fallback_ocr_provider_engine_name PASSED [ 25%]
tests/test_phase1_5_ocr_engine.py::TestOCREngineName::test_provider_without_engine_name_stores_unknown PASSED [ 25%]
tests/test_phase1_5_offset_guard.py::TestOffsetGuard::test_negative_offset_rejected PASSED [ 25%]
tests/test_phase1_5_offset_guard.py::TestOffsetGuard::test_offset_zero_accepted PASSED [ 25%]
tests/test_phase1_5_offset_guard.py::TestOffsetGuard::test_timestamp_before_chunk_start_rejected PASSED [ 26%]
tests/test_phase1_5_offset_guard.py::TestOffsetGuard::test_timestamp_after_chunk_end_rejected PASSED [ 26%]
tests/test_phase1_5_offset_guard.py::TestOffsetGuard::test_non_monotonic_offset_rejected PASSED [ 26%]
tests/test_phase1_5_offset_guard.py::TestOffsetGuard::test_valid_sequential_offsets_accepted PASSED [ 26%]
tests/test_phase1_5_offset_guard.py::TestOffsetGuard::test_missing_required_fields_rejected PASSED [ 26%]
tests/test_phase1_5_offset_guard.py::TestOffsetGuard::test_offset_guard_structured_log PASSED [ 27%]
tests/test_phase1_buffer_pool.py::test_pool_allocates_initial_capacity PASSED [ 27%]
tests/test_phase1_buffer_pool.py::test_pool_expands_to_power_of_two PASSED [ 27%]
tests/test_phase1_buffer_pool.py::test_pool_uses_temporary_buffer_when_above_limit PASSED [ 27%]
tests/test_phase1_degradation.py::TestFFmpegCrashRecovery::test_restart_count_increments PASSED [ 27%]
tests/test_phase1_degradation.py::TestFFmpegCrashRecovery::test_restart_count_resets_after_hour PASSED [ 28%]
tests/test_phase1_degradation.py::TestFFmpegCrashRecovery::test_restart_count_last_hour_property PASSED [ 28%]
tests/test_phase1_degradation.py::TestFFmpegCrashRecovery::test_restart_count_last_hour_current_window PASSED [ 28%]
tests/test_phase1_degradation.py::TestFFmpegCrashRecovery::test_watchdog_detects_crash PASSED [ 28%]
tests/test_phase1_degradation.py::TestDiskFullDegradation::test_check_disk_full_normal PASSED [ 28%]
tests/test_phase1_degradation.py::TestDiskFullDegradation::test_check_disk_full_simulated PASSED [ 29%]
tests/test_phase1_degradation.py::TestDiskFullDegradation::test_disk_full_flag_transitions PASSED [ 29%]
tests/test_phase1_degradation.py::TestDualModeRecording::test_screenshot_mode PASSED [ 29%]
tests/test_phase1_degradation.py::TestDualModeRecording::test_video_mode PASSED [ 29%]
tests/test_phase1_degradation.py::TestDualModeRecording::test_auto_mode_fallback PASSED [ 29%]
tests/test_phase1_degradation.py::TestUploadResume::test_upload_video_chunk_file_not_found PASSED [ 30%]
tests/test_phase1_degradation.py::TestUploadResume::test_upload_video_chunk_already_completed PASSED [ 30%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorExtraction::test_extract_frames_returns_list PASSED [ 30%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorExtraction::test_extracted_frames_have_correct_attributes PASSED [ 30%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorExtraction::test_frame_timestamps_are_sequential PASSED [ 30%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorExtraction::test_frame_pngs_are_valid_images PASSED [ 31%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorDedup::test_dedup_with_static_video PASSED [ 31%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorDedup::test_dedup_threshold_high_keeps_all PASSED [ 31%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorDedup::test_changing_video_keeps_more_frames PASSED [ 31%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorFFmpeg::test_run_ffmpeg_extraction PASSED [ 31%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorFFmpeg::test_run_ffmpeg_invalid_path PASSED [ 32%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorSingleFrame::test_extract_single_frame PASSED [ 32%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorSingleFrame::test_extract_single_frame_at_zero PASSED [ 32%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorSingleFrame::test_extract_single_frame_invalid_path PASSED [ 32%]
tests/test_phase1_frame_extractor.py::TestFrameExtractorPerformance::test_extraction_latency PASSED [ 32%]
tests/test_phase1_gates.py::TestGate1F01Recording::test_ffmpeg_command_builds PASSED [ 33%]
tests/test_phase1_gates.py::TestGate1F01Recording::test_video_recorder_chunk_metadata PASSED [ 33%]
tests/test_phase1_gates.py::TestGate1F02FramesInDB::test_frames_inserted_after_processing PASSED [ 33%]
tests/test_phase1_gates.py::TestGate1F03OCRInFTS::test_ocr_text_in_fts PASSED [ 33%]
tests/test_phase1_gates.py::TestGate1F04TimelineAPI::test_timeline_query PASSED [ 33%]
tests/test_phase1_gates.py::TestGate1F05SearchReturnsVideo::test_video_fts_search_returns_results PASSED [ 34%]
tests/test_phase1_gates.py::TestGate1P01ExtractionLatency::test_extraction_performance PASSED [ 34%]
tests/test_phase1_gates.py::TestGate1D01CrashRestart::test_restart_mechanism PASSED [ 34%]
tests/test_phase1_gates.py::TestGate1D02DiskFull::test_disk_full_detection PASSED [ 34%]
tests/test_phase1_gates.py::TestGate1D04NetworkDown::test_upload_failure_returns_false PASSED [ 34%]
tests/test_phase1_gates.py::TestGate1DG01FilesystemEncryption::test_filevault_status_check PASSED [ 35%]
tests/test_phase1_gates.py::TestGate1DG02AutoDelete::test_expired_chunks_detected PASSED [ 35%]
tests/test_phase1_gates.py::TestGate1DG02AutoDelete::test_cascade_delete_works PASSED [ 35%]
tests/test_phase1_gates.py::TestGate1S01Stability::test_7_day_stability SKIPPED [ 35%]
tests/test_phase1_gates.py::TestGate1S02UploadSuccess::test_upload_success_rate SKIPPED [ 35%]
tests/test_phase1_gates.py::TestGate1R01DiskUsage::test_disk_usage SKIPPED [ 36%]
tests/test_phase1_gates.py::TestGate1R02MemoryUsage::test_memory_usage SKIPPED [ 36%]
tests/test_phase1_gates.py::TestGate1P02E2ELatency::test_e2e_latency SKIPPED [ 36%]
tests/test_phase1_gates.py::TestGate1P03CPUOverhead::test_cpu_overhead SKIPPED [ 36%]
tests/test_phase1_gates.py::TestGate1Q01OCRAccuracy::test_ocr_accuracy SKIPPED [ 36%]
tests/test_phase1_gates.py::TestGate1Q02DedupAccuracy::test_dedup_accuracy PASSED [ 37%]
tests/test_phase1_gates.py::TestGate1DG03PIIDetection::test_pii_detection SKIPPED [ 37%]
tests/test_phase1_monitor_metadata_migration.py::test_migration_adds_monitor_columns PASSED [ 37%]
tests/test_phase1_monitor_metadata_migration.py::test_insert_video_chunk_persists_monitor_metadata PASSED [ 37%]
tests/test_phase1_monitor_metadata_migration.py::test_sql_store_init_auto_applies_video_migrations PASSED [ 37%]
tests/test_phase1_monitor_upload_api.py::test_upload_status_accepts_sha256_prefix PASSED [ 38%]
tests/test_phase1_monitor_upload_api.py::test_legacy_upload_status_accepts_sha256_prefix PASSED [ 38%]
tests/test_phase1_monitor_upload_api.py::test_video_upload_persists_monitor_metadata PASSED [ 38%]
tests/test_phase1_monitor_upload_api.py::test_legacy_upload_routes_video_chunk_to_video_table PASSED [ 38%]
tests/test_phase1_monitor_upload_api.py::test_legacy_video_upload_works_without_manual_migration PASSED [ 38%]
tests/test_phase1_ocr_pipeline.py::TestOCRTextInsertion::test_insert_ocr_text PASSED [ 39%]
tests/test_phase1_ocr_pipeline.py::TestOCRTextInsertion::test_insert_ocr_text_with_engine PASSED [ 39%]
tests/test_phase1_ocr_pipeline.py::TestOCRFTSInsertion::test_insert_ocr_text_fts PASSED [ 39%]
tests/test_phase1_ocr_pipeline.py::TestOCRFTSInsertion::test_fts_search_matches PASSED [ 39%]
tests/test_phase1_ocr_pipeline.py::TestOCRFTSInsertion::test_fts_search_no_match PASSED [ 39%]
tests/test_phase1_ocr_pipeline.py::TestOCRFTSInsertion::test_fts_multiple_frames PASSED [ 40%]
tests/test_phase1_ocr_pipeline.py::TestVideoChunkProcessor::test_processor_with_mock_ocr PASSED [ 40%]
tests/test_phase1_ocr_pipeline.py::TestVideoChunkProcessor::test_processor_handles_ocr_failure PASSED [ 40%]
tests/test_phase1_ocr_pipeline.py::TestVideoChunkProcessor::test_processor_propagates_chunk_app_window_to_frames_and_fts PASSED [ 40%]
tests/test_phase1_pipeline_profile_change.py::test_profile_change_triggers_reconfigure_once PASSED [ 40%]
tests/test_phase1_pipeline_profile_change.py::test_generation_mismatch_frame_is_dropped PASSED [ 41%]
tests/test_phase1_pipeline_profile_change.py::test_keepalive_writes_last_frame_when_source_quiet PASSED [ 41%]
tests/test_phase1_pipeline_profile_change.py::test_keepalive_respects_interval PASSED [ 41%]
tests/test_phase1_retention.py::TestRetentionQueries::test_get_expired_video_chunks PASSED [ 41%]
tests/test_phase1_retention.py::TestRetentionQueries::test_non_expired_chunks_not_returned PASSED [ 41%]
tests/test_phase1_retention.py::TestRetentionQueries::test_chunks_expired_over_30_days_are_returned PASSED [ 42%]
tests/test_phase1_retention.py::TestRetentionQueries::test_chunks_expiring_in_30_days_are_not_returned PASSED [ 42%]
tests/test_phase1_retention.py::TestRetentionQueries::test_pending_expired_chunks_not_returned PASSED [ 42%]
tests/test_phase1_retention.py::TestCascadeDelete::test_delete_video_chunk_cascade PASSED [ 42%]
tests/test_phase1_retention.py::TestCascadeDelete::test_fts_cleaned_on_cascade PASSED [ 42%]
tests/test_phase1_retention.py::TestRetentionWorker::test_cleanup_expired_video_chunks PASSED [ 43%]
tests/test_phase1_retention.py::TestRetentionWorker::test_cleanup_31_day_expired_chunk_deletes_all_related_data PASSED [ 43%]
tests/test_phase1_retention.py::TestRetentionWorker::test_retention_worker_stop PASSED [ 43%]
tests/test_phase1_sck_stride_unpadding.py::test_pack_nv12_planes_removes_padding PASSED [ 43%]
tests/test_phase1_sck_stride_unpadding.py::test_pack_bgra_plane_removes_padding PASSED [ 43%]
tests/test_phase1_search_debug_render.py::test_search_debug_handles_video_frame_only_rows PASSED [ 44%]
tests/test_phase1_search_debug_render.py::test_search_impl_debug_logging_handles_video_only_candidates PASSED [ 44%]
tests/test_phase1_search_integration.py::TestVideoFTSSearch::test_search_returns_matching_frames PASSED [ 44%]
tests/test_phase1_search_integration.py::TestVideoFTSSearch::test_search_returns_metadata PASSED [ 44%]
tests/test_phase1_search_integration.py::TestVideoFTSSearch::test_search_respects_limit PASSED [ 44%]
tests/test_phase1_search_integration.py::TestSQLStoreVideoMethods::test_insert_and_get_video_chunk PASSED [ 45%]
tests/test_phase1_search_integration.py::TestSQLStoreVideoMethods::test_video_chunk_status_transitions PASSED [ 45%]
tests/test_phase1_search_integration.py::TestSQLStoreVideoMethods::test_video_chunk_failed_status PASSED [ 45%]
tests/test_phase1_search_integration.py::TestSQLStoreVideoMethods::test_get_next_pending_fifo PASSED [ 45%]
tests/test_phase1_search_integration.py::TestSQLStoreVideoMethods::test_reset_stuck_video_chunks PASSED [ 45%]
tests/test_phase1_search_integration.py::TestSQLStoreVideoMethods::test_insert_and_get_frame PASSED [ 46%]
tests/test_phase1_search_integration.py::TestSQLStoreVideoMethods::test_query_frames_by_time_range PASSED [ 46%]
tests/test_phase1_search_integration.py::TestSQLStoreVideoMethods::test_insert_frames_batch PASSED [ 46%]
tests/test_phase1_server_startup.py::test_server_main_starts_background_worker PASSED [ 46%]
tests/test_phase1_server_startup.py::test_server_main_starts_video_worker PASSED [ 46%]
tests/test_phase1_server_startup.py::test_server_preload_ai_models_includes_ocr_warmup PASSED [ 47%]
tests/test_phase1_timeline_api.py::TestTimelineAPI::test_timeline_returns_paginated_response PASSED [ 47%]
tests/test_phase1_timeline_api.py::TestTimelineAPI::test_timeline_time_range_filter PASSED [ 47%]
tests/test_phase1_timeline_api.py::TestTimelineAPI::test_timeline_pagination PASSED [ 47%]
tests/test_phase1_timeline_api.py::TestTimelineAPI::test_timeline_frame_urls PASSED [ 47%]
tests/test_phase1_timeline_api.py::TestTimelineAPI::test_timeline_empty_range PASSED [ 48%]
tests/test_phase1_timeline_api.py::TestTimelineAPI::test_timeline_accepts_page_and_page_size PASSED [ 48%]
tests/test_phase1_timeline_api.py::TestTimelineAPI::test_timeline_limit_offset_take_precedence_over_page_aliases PASSED [ 48%]
tests/test_phase1_timeline_api.py::TestTimelineAPI::test_legacy_timeline_page_uses_frame_urls PASSED [ 48%]
tests/test_phase1_timeline_api.py::TestTimelineAPI::test_legacy_memories_recent_returns_frame_image_url PASSED [ 48%]
tests/test_phase1_timeline_api.py::TestTimelineAPI::test_legacy_queue_status_includes_video_counts PASSED [ 49%]
tests/test_phase1_timeline_api.py::TestFrameServingAPI::test_serve_existing_frame PASSED [ 49%]
tests/test_phase1_timeline_api.py::TestFrameServingAPI::test_serve_nonexistent_frame PASSED [ 49%]
tests/test_phase1_timeline_api.py::TestVideoUploadAPI::test_upload_video_chunk PASSED [ 49%]
tests/test_phase1_timeline_api.py::TestVideoUploadAPI::test_upload_screenshot_still_works PASSED [ 50%]
tests/test_phase1_timeline_api.py::TestUploadStatusAPI::test_upload_status_not_found PASSED [ 50%]
tests/test_phase1_timeline_api.py::TestUploadStatusAPI::test_upload_status_missing_checksum PASSED [ 50%]
tests/test_phase1_timeline_api.py::TestSearchPaginationCompatibility::test_search_accepts_page_and_page_size_when_query_empty PASSED [ 50%]
tests/test_phase1_timeline_api.py::TestSearchPaginationCompatibility::test_search_limit_offset_take_precedence_when_both_styles_provided PASSED [ 50%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerCommand::test_build_command_has_required_flags PASSED [ 51%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerCommand::test_build_command_platform_specific PASSED [ 51%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerCommand::test_build_command_darwin_detects_screen_index PASSED [ 51%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerCommand::test_build_command_darwin_honors_device_override PASSED [ 51%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerCommand::test_build_command_darwin_fallbacks_to_screen_name PASSED [ 51%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerCommand::test_build_command_includes_segment_list PASSED [ 52%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerCommand::test_build_command_uses_monitor_timestamp_pattern PASSED [ 52%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerCommand::test_custom_resolution_adds_scale_filter PASSED [ 52%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerLifecycle::test_check_ffmpeg_available PASSED [ 52%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerLifecycle::test_start_creates_process PASSED [ 52%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerLifecycle::test_stop_terminates_process PASSED [ 53%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerLifecycle::test_stop_skips_stdin_close_when_write_lock_held PASSED [ 53%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerLifecycle::test_restart_increments_counter PASSED [ 53%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerLifecycle::test_restart_count_resets_after_hour PASSED [ 53%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerLifecycle::test_restart_count_last_hour_property PASSED [ 53%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerLifecycle::test_restart_count_last_hour_current PASSED [ 54%]
tests/test_phase1_video_recorder.py::TestFFmpegManagerLifecycle::test_start_raises_without_ffmpeg PASSED [ 54%]
tests/test_phase1_video_recorder.py::TestFFmpegRawVideoProfile::test_start_with_profile_builds_rawvideo_input PASSED [ 54%]
tests/test_phase1_video_recorder.py::TestFFmpegRawVideoProfile::test_reconfigure_restarts_on_profile_change PASSED [ 54%]
tests/test_phase1_video_recorder.py::TestFFmpegRawVideoProfile::test_build_rawvideo_command_chunk_process_has_single_output PASSED [ 54%]
tests/test_phase1_video_recorder.py::TestFFmpegRawVideoProfile::test_chunk_process_rotates_and_emits_chunk_completion PASSED [ 55%]
tests/test_phase1_video_recorder.py::TestFFmpegRawVideoProfile::test_write_frame_timeout_raises_timeout_error PASSED [ 55%]
tests/test_phase1_video_recorder.py::TestFFmpegSegmentPolling::test_read_segment_list_empty PASSED [ 55%]
tests/test_phase1_video_recorder.py::TestFFmpegSegmentPolling::test_read_segment_list_csv PASSED [ 55%]
tests/test_phase1_video_recorder.py::TestFFmpegSegmentPolling::test_poll_segments_detects_new PASSED [ 55%]
tests/test_phase1_video_recorder.py::TestFFmpegSegmentPolling::test_poll_segments_no_duplicate PASSED [ 56%]
tests/test_phase1_video_recorder.py::TestFFmpegSegmentPolling::test_current_chunk_path_uses_last_detected_segment PASSED [ 56%]
tests/test_phase1_video_recorder.py::TestFFmpegSegmentPolling::test_current_chunk_path_falls_back_to_csv_last_existing PASSED [ 56%]
tests/test_phase1_video_recorder.py::TestFFmpegSegmentPolling::test_on_chunk_complete_callback PASSED [ 56%]
tests/test_phase1_video_recorder.py::TestMonitorPipelineController::test_controller_reconfigures_when_ffmpeg_write_times_out PASSED [ 56%]
tests/test_phase1_video_recorder.py::TestMonitorPipelineController::test_logs_chunk_start_once_per_new_active_file PASSED [ 57%]
tests/test_phase1_video_recorder.py::TestMonitorPipelineController::test_logs_chunk_start_is_idempotent_when_detector_flaps PASSED [ 57%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_on_chunk_complete_builds_metadata PASSED [ 57%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_on_chunk_complete_logs_chunk_end PASSED [ 57%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_on_chunk_complete_skips_empty PASSED [ 57%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_on_chunk_complete_skips_missing PASSED [ 58%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_check_disk_full PASSED [ 58%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_compute_checksum PASSED [ 58%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_stop_sets_flag PASSED [ 58%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_runtime_pause_stops_sources_not_pipelines PASSED [ 58%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_runtime_resume_restarts_sources_from_existing_pipelines PASSED [ 59%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_periodic_status_logs_current_chunk PASSED [ 59%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_periodic_status_prefers_active_chunk_name PASSED [ 59%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_watcher_restarts_pipeline_when_chunk_stagnates PASSED [ 59%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_watcher_restarts_segment_mode_on_no_chunk_progress PASSED [ 59%]
tests/test_phase1_video_recorder.py::TestVideoRecorder::test_watcher_does_not_restart_chunk_process_on_chunk_name_stagnation PASSED [ 60%]
tests/test_phase2_audio_manager.py::TestListAudioDevices::test_returns_input_devices PASSED [ 60%]
tests/test_phase2_audio_manager.py::TestListAudioDevices::test_returns_empty_on_error PASSED [ 60%]
tests/test_phase2_audio_manager.py::TestAudioManager::test_init_defaults PASSED [ 60%]
tests/test_phase2_audio_manager.py::TestAudioManager::test_is_alive_false_when_not_started PASSED [ 60%]
tests/test_phase2_audio_manager.py::TestAudioManager::test_resolve_device_by_index PASSED [ 61%]
tests/test_phase2_audio_manager.py::TestAudioManager::test_resolve_device_by_name PASSED [ 61%]
tests/test_phase2_audio_manager.py::TestAudioManager::test_resolve_device_not_found PASSED [ 61%]
tests/test_phase2_audio_manager.py::TestAudioManager::test_start_new_chunk_creates_wav PASSED [ 61%]
tests/test_phase2_audio_manager.py::TestAudioManager::test_close_chunk_fires_callback PASSED [ 61%]
tests/test_phase2_audio_manager.py::TestAudioManager::test_close_empty_chunk_removes_file PASSED [ 62%]
tests/test_phase2_audio_manager.py::TestAudioManager::test_audio_callback_writes_frames PASSED [ 62%]
tests/test_phase2_audio_manager.py::TestAudioManager::test_audio_callback_rotates_on_duration PASSED [ 62%]
tests/test_phase2_audio_manager.py::TestAudioManager::test_stop_flushes_chunk PASSED [ 62%]
tests/test_phase2_audio_recorder.py::TestAudioRecorder::test_init_defaults PASSED [ 62%]
tests/test_phase2_audio_recorder.py::TestAudioRecorder::test_is_running_false_when_stopped PASSED [ 63%]
tests/test_phase2_audio_recorder.py::TestAudioRecorder::test_stop_when_not_running PASSED [ 63%]
tests/test_phase2_audio_recorder.py::TestAudioRecorder::test_on_chunk_complete_enqueues_with_metadata PASSED [ 63%]
tests/test_phase2_audio_recorder.py::TestAudioRecorder::test_on_chunk_complete_correct_checksum PASSED [ 63%]
tests/test_phase2_audio_recorder.py::TestAudioRecorder::test_on_chunk_complete_skips_empty_wav PASSED [ 63%]
tests/test_phase2_audio_recorder.py::TestAudioRecorder::test_on_chunk_complete_nonexistent_file PASSED [ 64%]
tests/test_phase2_gates.py::TestGate2F01AudioCapture::test_audio_manager_creates_wav PASSED [ 64%]
tests/test_phase2_gates.py::TestGate2F01AudioCapture::test_audio_manager_device_name_sanitized PASSED [ 64%]
tests/test_phase2_gates.py::TestGate2F02VADFiltering::test_vad_filters_silence PASSED [ 64%]
tests/test_phase2_gates.py::TestGate2F02VADFiltering::test_vad_detects_speech_subset PASSED [ 64%]
tests/test_phase2_gates.py::TestGate2F03WhisperTranscription::test_transcriber_produces_text PASSED [ 65%]
tests/test_phase2_gates.py::TestGate2F03WhisperTranscription::test_transcriber_handles_empty_audio PASSED [ 65%]
tests/test_phase2_gates.py::TestGate2F04AudioFTSIndexed::test_fts_insert_and_match PASSED [ 65%]
tests/test_phase2_gates.py::TestGate2F04AudioFTSIndexed::test_fts_no_results_for_unrelated_query PASSED [ 65%]
tests/test_phase2_gates.py::TestGate2F05UnifiedTimeline::test_timeline_returns_both_types PASSED [ 65%]
tests/test_phase2_gates.py::TestGate2P01TranscriptionLatency::test_transcription_completes_within_budget PASSED [ 66%]
tests/test_phase2_gates.py::TestGate2P02VADLatency::test_vad_completes_within_budget PASSED [ 66%]
tests/test_phase2_gates.py::TestGate2P03Throughput::test_queue_depth_stable PASSED [ 66%]
tests/test_phase2_gates.py::TestGate2P04AudioCaptureCPU::test_callback_based_design PASSED [ 66%]
tests/test_phase2_gates.py::TestGate2Q01WERClean::test_wer_clean_under_threshold PASSED [ 66%]
tests/test_phase2_gates.py::TestGate2Q01WERClean::test_wer_clean_with_one_error PASSED [ 67%]
tests/test_phase2_gates.py::TestGate2Q02WERNoisy::test_wer_noisy_under_threshold PASSED [ 67%]
tests/test_phase2_gates.py::TestGate2Q02WERNoisy::test_wer_noisy_boundary PASSED [ 67%]
tests/test_phase2_gates.py::TestGate2S01Stability::test_24h_continuous_run SKIPPED [ 67%]
tests/test_phase2_gates.py::TestGate2R01VRAM::test_vram_usage_structural SKIPPED [ 67%]
tests/test_phase2_gates.py::TestGate2R02StorageRate::test_wav_file_size_reasonable PASSED [ 68%]
tests/test_phase2_gates.py::TestGate2R02StorageRate::test_daily_storage_estimate PASSED [ 68%]
tests/test_phase2_gates.py::TestGate2DG01Encryption::test_filevault_status_command PASSED [ 68%]
tests/test_phase2_gates.py::TestGate2DG01Encryption::test_luks_check_structural SKIPPED [ 68%]
tests/test_phase2_gates.py::TestGate2DG02Redaction::test_pii_redaction SKIPPED [ 68%]
tests/test_phase2_gates.py::TestGate2DG03Retention::test_cascade_delete_removes_all PASSED [ 69%]
tests/test_phase2_gates.py::TestGate2DG03Retention::test_expired_chunks_detected PASSED [ 69%]
tests/test_phase2_ingestion.py::TestAudioUploadAPI::test_audio_upload_accepted PASSED [ 69%]
tests/test_phase2_ingestion.py::TestAudioUploadAPI::test_audio_upload_creates_db_entry PASSED [ 69%]
tests/test_phase2_ingestion.py::TestAudioUploadAPI::test_audio_upload_by_content_type PASSED [ 69%]
tests/test_phase2_ingestion.py::TestAudioUploadAPI::test_audio_upload_by_filename PASSED [ 70%]
tests/test_phase2_ingestion.py::TestAudioUploadAPI::test_upload_no_file_returns_400 PASSED [ 70%]
tests/test_phase2_ingestion.py::TestAudioUploadAPI::test_upload_no_metadata_returns_400 PASSED [ 70%]
tests/test_phase2_ingestion.py::TestAudioChunksListAPI::test_list_audio_chunks_empty PASSED [ 70%]
tests/test_phase2_ingestion.py::TestAudioChunksListAPI::test_list_audio_chunks_after_upload PASSED [ 70%]
tests/test_phase2_ingestion.py::TestAudioChunksListAPI::test_list_audio_chunks_status_filter PASSED [ 71%]
tests/test_phase2_ingestion.py::TestQueueStatusAudio::test_queue_status_includes_audio PASSED [ 71%]
tests/test_phase2_performance.py::TestGate2P01TranscriptionLatency::test_mock_transcription_latency PASSED [ 71%]
tests/test_phase2_performance.py::TestGate2P01TranscriptionLatency::test_real_transcription_latency SKIPPED [ 71%]
tests/test_phase2_performance.py::TestGate2P02VADProcessing::test_mock_vad_latency PASSED [ 71%]
tests/test_phase2_performance.py::TestGate2P02VADProcessing::test_real_vad_latency SKIPPED [ 72%]
tests/test_phase2_performance.py::TestGate2P03Throughput::test_no_backlog_growth_pattern PASSED [ 72%]
tests/test_phase2_performance.py::TestGate2P03Throughput::test_mock_queue_depth_stable PASSED [ 72%]
tests/test_phase2_performance.py::TestGate2P04AudioCaptureCPU::test_audio_manager_structural_attributes PASSED [ 72%]
tests/test_phase2_performance.py::TestGate2P04AudioCaptureCPU::test_audio_manager_callback_writes_frames PASSED [ 72%]
tests/test_phase2_performance.py::TestGate2P04AudioCaptureCPU::test_real_cpu_usage SKIPPED [ 73%]
tests/test_phase2_quality.py::TestComputeWER::test_identical_strings PASSED [ 73%]
tests/test_phase2_quality.py::TestComputeWER::test_one_substitution PASSED [ 73%]
tests/test_phase2_quality.py::TestComputeWER::test_completely_wrong PASSED [ 73%]
tests/test_phase2_quality.py::TestComputeWER::test_empty_both PASSED     [ 73%]
tests/test_phase2_quality.py::TestComputeWER::test_empty_reference PASSED [ 74%]
tests/test_phase2_quality.py::TestComputeWER::test_empty_hypothesis PASSED [ 74%]
tests/test_phase2_quality.py::TestComputeWER::test_insertion PASSED      [ 74%]
tests/test_phase2_quality.py::TestComputeWER::test_deletion PASSED       [ 74%]
tests/test_phase2_quality.py::TestComputeWER::test_case_insensitive PASSED [ 74%]
tests/test_phase2_quality.py::TestComputeWER::test_longer_sentence PASSED [ 75%]
tests/test_phase2_quality.py::TestGate2Q01WERClean::test_wer_clean_with_mock_whisper PASSED [ 75%]
tests/test_phase2_quality.py::TestGate2Q01WERClean::test_wer_clean_realistic_error PASSED [ 75%]
tests/test_phase2_quality.py::TestGate2Q01WERClean::test_wer_clean_with_minor_errors PASSED [ 75%]
tests/test_phase2_quality.py::TestGate2Q01WERClean::test_real_wer_clean_speech SKIPPED [ 75%]
tests/test_phase2_quality.py::TestGate2Q02WERNoisy::test_wer_noisy_with_mock_whisper PASSED [ 76%]
tests/test_phase2_quality.py::TestGate2Q02WERNoisy::test_wer_noisy_realistic_errors PASSED [ 76%]
tests/test_phase2_quality.py::TestGate2Q02WERNoisy::test_wer_noisy_boundary_case PASSED [ 76%]
tests/test_phase2_quality.py::TestGate2Q02WERNoisy::test_real_wer_noisy_speech SKIPPED [ 76%]
tests/test_phase2_search.py::TestAudioFTSSearch::test_insert_and_search_transcription PASSED [ 76%]
tests/test_phase2_search.py::TestAudioFTSSearch::test_search_no_results PASSED [ 77%]
tests/test_phase2_search.py::TestAudioFTSSearch::test_search_audio_fts_pagination PASSED [ 77%]
tests/test_phase2_search.py::TestAudioFTSSearch::test_get_audio_transcriptions_by_time_range PASSED [ 77%]
tests/test_phase2_search.py::TestAudioFTSSearch::test_get_audio_transcriptions_outside_range PASSED [ 77%]
tests/test_phase2_search.py::TestSearchAPIAudio::test_search_endpoint_exists PASSED [ 77%]
tests/test_phase2_search.py::TestSearchAPIAudio::test_search_empty_query PASSED [ 78%]
tests/test_phase2_smoke.py::TestPhase2SmokeEndToEnd::test_full_audio_pipeline PASSED [ 78%]
tests/test_phase2_smoke.py::TestPhase2SmokeEndToEnd::test_audio_upload_then_chunks_status PASSED [ 78%]
tests/test_phase2_timeline.py::TestTimelineAPI::test_timeline_endpoint_exists PASSED [ 78%]
tests/test_phase2_timeline.py::TestTimelineAPI::test_timeline_empty_range PASSED [ 78%]
tests/test_phase2_timeline.py::TestTimelineAPI::test_timeline_with_audio_transcriptions PASSED [ 79%]
tests/test_phase2_timeline.py::TestTimelineAPI::test_timeline_source_filter_audio PASSED [ 79%]
tests/test_phase2_timeline.py::TestTimelineAPI::test_timeline_source_filter_video PASSED [ 79%]
tests/test_phase2_timeline.py::TestTimelineAPI::test_timeline_pagination PASSED [ 79%]
tests/test_phase2_timeline.py::TestTimelineAPI::test_timeline_invalid_times PASSED [ 79%]
tests/test_phase2_timeline.py::TestAudioTranscriptionsAPI::test_transcriptions_endpoint_exists PASSED [ 80%]
tests/test_phase2_timeline.py::TestAudioTranscriptionsAPI::test_transcriptions_with_data PASSED [ 80%]
tests/test_phase2_transcriber.py::TestTranscriptionSegment::test_fields PASSED [ 80%]
tests/test_phase2_transcriber.py::TestWhisperTranscriber::test_init_defaults PASSED [ 80%]
tests/test_phase2_transcriber.py::TestWhisperTranscriber::test_init_custom PASSED [ 80%]
tests/test_phase2_transcriber.py::TestWhisperTranscriber::test_engine_name PASSED [ 81%]
tests/test_phase2_transcriber.py::TestWhisperTranscriber::test_transcribe_no_model_returns_empty PASSED [ 81%]
tests/test_phase2_transcriber.py::TestWhisperTranscriber::test_transcribe_returns_segments PASSED [ 81%]
tests/test_phase2_transcriber.py::TestWhisperTranscriber::test_transcribe_filters_empty_text PASSED [ 81%]
tests/test_phase2_transcriber.py::TestWhisperTranscriber::test_reinit_on_cpu PASSED [ 81%]
tests/test_phase2_vad.py::TestSpeechSegment::test_fields PASSED          [ 82%]
tests/test_phase2_vad.py::TestVoiceActivityDetector::test_init_defaults PASSED [ 82%]
tests/test_phase2_vad.py::TestVoiceActivityDetector::test_init_custom PASSED [ 82%]
tests/test_phase2_vad.py::TestVoiceActivityDetector::test_no_model_returns_empty PASSED [ 82%]
tests/test_phase2_vad.py::TestVoiceActivityDetector::test_has_speech_delegates_to_get_segments PASSED [ 82%]
tests/test_phase2_vad.py::TestVoiceActivityDetector::test_webrtcvad_segments_on_silence SKIPPED [ 83%]
tests/test_phase2_vad.py::TestVoiceActivityDetector::test_webrtcvad_segments_on_noise SKIPPED [ 83%]
tests/test_phase2_vad.py::TestVoiceActivityDetector::test_invalid_wav_returns_empty PASSED [ 83%]
tests/test_phase2_worker.py::TestAudioProcessingResult::test_defaults PASSED [ 83%]
tests/test_phase2_worker.py::TestAudioProcessingResult::test_with_error PASSED [ 83%]
tests/test_phase2_worker.py::TestAudioChunkProcessor::test_init_lazy PASSED [ 84%]
tests/test_phase2_worker.py::TestAudioChunkProcessor::test_process_missing_file PASSED [ 84%]
tests/test_phase2_worker.py::TestAudioChunkProcessor::test_process_no_speech PASSED [ 84%]
tests/test_phase2_worker.py::TestAudioChunkProcessor::test_process_with_speech PASSED [ 84%]
tests/test_phase2_worker.py::TestAudioProcessingWorker::test_init PASSED [ 84%]
tests/test_phase2_worker.py::TestAudioProcessingWorker::test_stop_event PASSED [ 85%]
tests/test_phase2_worker.py::TestSQLStoreAudioLifecycle::test_insert_audio_chunk PASSED [ 85%]
tests/test_phase2_worker.py::TestSQLStoreAudioLifecycle::test_get_audio_chunk_by_id PASSED [ 85%]
tests/test_phase2_worker.py::TestSQLStoreAudioLifecycle::test_pending_processing_completed_lifecycle PASSED [ 85%]
tests/test_phase2_worker.py::TestSQLStoreAudioLifecycle::test_pending_processing_failed_lifecycle PASSED [ 85%]
tests/test_phase2_worker.py::TestSQLStoreAudioLifecycle::test_reset_stuck_audio_chunks PASSED [ 86%]
tests/test_phase2_worker.py::TestSQLStoreAudioLifecycle::test_get_next_pending_audio_chunk PASSED [ 86%]
tests/test_phase2_worker.py::TestSQLStoreAudioLifecycle::test_audio_chunk_status_counts Fatal Python error: Segmentation fault

Current thread 0x0000000171d07000 (most recent call first):
  <no Python frame>

Thread 0x00000003830c3000 (most recent call first):
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 331 in wait
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/queue.py", line 180 in get
  File "/Users/pyw/new/MyRecall/openrecall/client/video_recorder.py", line 228 in _drain_once
  File "/Users/pyw/new/MyRecall/openrecall/client/video_recorder.py", line 202 in _writer_loop
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 982 in run
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x00000003820b7000 (most recent call first):
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 331 in wait
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 629 in wait
  File "/Users/pyw/new/MyRecall/openrecall/client/ffmpeg_manager.py", line 581 in _watchdog_loop
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 982 in run
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x000000037792b000 (most recent call first):
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 331 in wait
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/queue.py", line 180 in get
  File "/Users/pyw/new/MyRecall/openrecall/client/video_recorder.py", line 228 in _drain_once
  File "/Users/pyw/new/MyRecall/openrecall/client/video_recorder.py", line 202 in _writer_loop
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 982 in run
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x000000037691f000 (most recent call first):
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 331 in wait
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/queue.py", line 180 in get
  File "/Users/pyw/new/MyRecall/openrecall/client/video_recorder.py", line 228 in _drain_once
  File "/Users/pyw/new/MyRecall/openrecall/client/video_recorder.py", line 202 in _writer_loop
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 982 in run
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000000375913000 (most recent call first):
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 331 in wait
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/queue.py", line 180 in get
  File "/Users/pyw/new/MyRecall/openrecall/client/video_recorder.py", line 228 in _drain_once
  File "/Users/pyw/new/MyRecall/openrecall/client/video_recorder.py", line 202 in _writer_loop
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 982 in run
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000000374907000 (most recent call first):
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 331 in wait
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/queue.py", line 180 in get
  File "/Users/pyw/new/MyRecall/openrecall/client/video_recorder.py", line 228 in _drain_once
  File "/Users/pyw/new/MyRecall/openrecall/client/video_recorder.py", line 202 in _writer_loop
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 982 in run
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x000000031ad3b000 (most recent call first):
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/selectors.py", line 566 in select
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/asyncio/base_events.py", line 1898 in _run_once
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/asyncio/base_events.py", line 608 in run_forever
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 982 in run
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x00000001f5952c40 (most recent call first):
  File "/Users/pyw/new/MyRecall/openrecall/server/database/migrations/runner.py", line 187 in run
  File "/Users/pyw/new/MyRecall/openrecall/server/database/sql.py", line 72 in _run_migrations
  File "/Users/pyw/new/MyRecall/openrecall/server/database/sql.py", line 66 in _init_db
  File "/Users/pyw/new/MyRecall/openrecall/server/database/sql.py", line 24 in __init__
  File "/Users/pyw/new/MyRecall/tests/test_phase2_worker.py", line 148 in sql_store
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/fixtures.py", line 915 in call_fixture_func
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/fixtures.py", line 1202 in pytest_fixture_setup
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_callers.py", line 121 in _multicall
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_manager.py", line 120 in _hookexec
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_hooks.py", line 512 in __call__
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/fixtures.py", line 1110 in execute
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/fixtures.py", line 627 in _get_active_fixturedef
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/fixtures.py", line 539 in getfixturevalue
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/fixtures.py", line 707 in _fillfixtures
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/python.py", line 1723 in setup
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/runner.py", line 523 in setup
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/runner.py", line 165 in pytest_runtest_setup
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_callers.py", line 121 in _multicall
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_manager.py", line 120 in _hookexec
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_hooks.py", line 512 in __call__
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/runner.py", line 245 in <lambda>
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/runner.py", line 353 in from_call
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/runner.py", line 244 in call_and_report
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/runner.py", line 131 in runtestprotocol
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/runner.py", line 118 in pytest_runtest_protocol
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_callers.py", line 121 in _multicall
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_manager.py", line 120 in _hookexec
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_hooks.py", line 512 in __call__
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/main.py", line 396 in pytest_runtestloop
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_callers.py", line 121 in _multicall
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_manager.py", line 120 in _hookexec
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_hooks.py", line 512 in __call__
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/main.py", line 372 in _main
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/main.py", line 318 in wrap_session
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/main.py", line 365 in pytest_cmdline_main
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_callers.py", line 121 in _multicall
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_manager.py", line 120 in _hookexec
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pluggy/_hooks.py", line 512 in __call__
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/config/__init__.py", line 199 in main
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/_pytest/config/__init__.py", line 223 in console_main
  File "/opt/homebrew/Caskroom/miniforge/base/envs/v3/lib/python3.11/site-packages/pytest/__main__.py", line 9 in <module>
  File "<frozen runpy>", line 88 in _run_code
  File "<frozen runpy>", line 198 in _run_module_as_main

Extension modules: PIL._imaging, numpy.core._multiarray_umath, numpy.core._multiarray_tests, numpy.linalg._umath_linalg, numpy.fft._pocketfft_internal, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._mt19937, numpy.random.mtrand, numpy.random._philox, numpy.random._pcg64, numpy.random._sfc64, numpy.random._generator, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, yaml._yaml, regex._regex, markupsafe._speedups, sklearn.__check_build._check_build, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.spatial._ckdtree, scipy._lib.messagestream, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._group_columns, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.optimize._direct, scipy.integrate._odepack, scipy.integrate._quadpack, scipy.integrate._vode, scipy.integrate._dop, scipy.interpolate._fitpack, scipy.interpolate._dfitpack, scipy.interpolate._dierckx, scipy.interpolate._ppoly, scipy.interpolate._interpnd, scipy.interpolate._rbfinterp_pythran, scipy.interpolate._rgi_cython, scipy.special.cython_special, scipy.stats._stats, scipy.stats._biasedurn, scipy.stats._stats_pythran, scipy.stats._levy_stable.levyst, scipy.stats._ansari_swilk_statistics, scipy.sparse.csgraph._tools, scipy.sparse.csgraph._shortest_path, scipy.sparse.csgraph._traversal, scipy.sparse.csgraph._min_spanning_tree, scipy.sparse.csgraph._flow, scipy.sparse.csgraph._matching, scipy.sparse.csgraph._reordering, scipy.stats._sobol, scipy.stats._qmc_cy, scipy.stats._rcont.rcont, scipy.stats._qmvnt_cy, scipy.ndimage._nd_image, scipy.ndimage._rank_filter_1d, _ni_label, scipy.ndimage._ni_label, pyarrow.lib, sklearn._cyutility, sklearn.utils._isfinite, sklearn.utils.sparsefuncs_fast, sklearn.utils.murmurhash, sklearn.utils._openmp_helpers, sklearn.metrics.cluster._expected_mutual_info_fast, sklearn.metrics._dist_metrics, sklearn.metrics._pairwise_distances_reduction._datasets_pair, sklearn.utils._cython_blas, sklearn.metrics._pairwise_distances_reduction._base, sklearn.metrics._pairwise_distances_reduction._middle_term_computer, sklearn.utils._heap, sklearn.utils._sorting, sklearn.metrics._pairwise_distances_reduction._argkmin, sklearn.metrics._pairwise_distances_reduction._argkmin_classmode, sklearn.utils._vector_sentinel, sklearn.metrics._pairwise_distances_reduction._radius_neighbors, sklearn.metrics._pairwise_distances_reduction._radius_neighbors_classmode, sklearn.metrics._pairwise_fast, sklearn.preprocessing._csr_polynomial_expansion, sklearn.preprocessing._target_encoder_fast, PIL._imagingft, av._core, av.logging, av.bytesource, av.buffer, av.audio.format, av.error, av.dictionary, av.container.pyio, av.option, av.descriptor, av.format, av.utils, av.stream, av.container.streams, av.sidedata.encparams, av.sidedata.motionvectors, av.sidedata.sidedata, av.opaque, av.packet, av.container.input, av.container.output, av.container.core, av.codec.context, av.video.format, av.video.reformatter, av.plane, av.video.plane, av.video.frame, av.video.stream, av.codec.hwaccel, av.codec.codec, av.frame, av.audio.layout, av.audio.plane, av.audio.frame, av.audio.stream, av.filter.link, av.filter.context, av.filter.graph, av.filter.filter, av.filter.loudnorm, av.audio.resampler, av.audio.codeccontext, av.audio.fifo, av.bitstream, av.video.codeccontext, pyarrow._compute, pyarrow._acero, pyarrow._fs, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, objc._objc, CoreFoundation._CoreFoundation, CoreFoundation._inlines, Foundation._Foundation, Foundation._inlines, ScreenCaptureKit._ScreenCaptureKit, CoreMedia._CoreMedia, CoreMedia._inlines, AppKit._AppKit, AppKit._inlines, Quartz.CoreGraphics._callbacks, Quartz.CoreGraphics._doubleindirect, Quartz.CoreGraphics._sortandmap, Quartz.CoreGraphics._coregraphics, Quartz.CoreGraphics._inlines, Quartz.ImageKit._imagekit, Quartz.CoreVideo._CVPixelBuffer, Quartz.QuartzCore._quartzcore, Quartz.PDFKit._PDFKit, Quartz.QuickLookUI._QuickLookUI, dispatch._dispatch, dispatch._inlines, pyclipper._pyclipper, shapely.lib, shapely._geos, shapely._geometry_helpers, PIL._imagingmath, PIL._webp (total: 227)
