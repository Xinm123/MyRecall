============================= test session starts ==============================
platform darwin -- Python 3.11.14, pytest-9.0.2, pluggy-1.6.0 -- /opt/homebrew/Caskroom/miniforge/base/envs/v3/bin/python3
cachedir: .pytest_cache
rootdir: /Users/pyw/new/MyRecall
configfile: pytest.ini
plugins: anyio-4.12.1
collecting ... collected 86 items

tests/test_phase0_api_v1.py::TestV1Health::test_v1_health PASSED         [  1%]
tests/test_phase0_api_v1.py::TestV1Health::test_legacy_health PASSED     [  2%]
tests/test_phase0_api_v1.py::TestV1MemoriesRecent::test_paginated_envelope PASSED [  3%]
tests/test_phase0_api_v1.py::TestV1MemoriesRecent::test_default_pagination PASSED [  4%]
tests/test_phase0_api_v1.py::TestV1MemoriesLatest::test_paginated_envelope PASSED [  5%]
tests/test_phase0_api_v1.py::TestV1MemoriesLatest::test_invalid_since PASSED [  6%]
tests/test_phase0_api_v1.py::TestV1Search::test_search_paginated PASSED  [  8%]
tests/test_phase0_api_v1.py::TestV1Search::test_empty_query PASSED       [  9%]
tests/test_phase0_api_v1.py::TestV1Upload::test_upload PASSED            [ 10%]
tests/test_phase0_api_v1.py::TestV1Upload::test_upload_no_file PASSED    [ 11%]
tests/test_phase0_api_v1.py::TestV1Config::test_get_config PASSED        [ 12%]
tests/test_phase0_api_v1.py::TestV1Config::test_post_config PASSED       [ 13%]
tests/test_phase0_api_v1.py::TestV1Heartbeat::test_heartbeat PASSED      [ 15%]
tests/test_phase0_api_v1.py::TestV1QueueStatus::test_queue_status PASSED [ 16%]
tests/test_phase0_api_v1.py::TestAuthDecorator::test_all_v1_routes_have_auth PASSED [ 17%]
tests/test_phase0_backward_compat.py::TestFullV2Pipeline::test_upload_query_after_migration PASSED [ 18%]
tests/test_phase0_backward_compat.py::TestLegacyApiUntouched::test_all_legacy_endpoints PASSED [ 19%]
tests/test_phase0_backward_compat.py::TestV1AndLegacyCoexist::test_both_health_endpoints PASSED [ 20%]
tests/test_phase0_backward_compat.py::TestQueryOverhead::test_query_overhead_under_10ms PASSED [ 22%]
tests/test_phase0_config_matrix.py::TestDeploymentMode::test_local_defaults PASSED [ 23%]
tests/test_phase0_config_matrix.py::TestDeploymentMode::test_no_mode_defaults_to_local PASSED [ 24%]
tests/test_phase0_config_matrix.py::TestDeploymentMode::test_deployment_mode_set_via_env PASSED [ 25%]
tests/test_phase0_config_matrix.py::TestConfigPresets::test_get_preset_local PASSED [ 26%]
tests/test_phase0_config_matrix.py::TestConfigPresets::test_get_preset_debian_server PASSED [ 27%]
tests/test_phase0_config_matrix.py::TestConfigPresets::test_get_preset_debian_client PASSED [ 29%]
tests/test_phase0_config_matrix.py::TestConfigPresets::test_get_preset_remote PASSED [ 30%]
tests/test_phase0_config_matrix.py::TestConfigPresets::test_invalid_mode_raises PASSED [ 31%]
tests/test_phase0_config_matrix.py::TestConfigPresets::test_all_four_modes_defined PASSED [ 32%]
tests/test_phase0_config_matrix.py::TestEnvTemplates::test_all_env_files_exist PASSED [ 33%]
tests/test_phase0_config_matrix.py::TestEnvTemplates::test_env_files_contain_deployment_mode PASSED [ 34%]
tests/test_phase0_config_matrix.py::TestEnvTemplates::test_debian_server_binds_all PASSED [ 36%]
tests/test_phase0_gates.py::TestGateF01Schema–úigrationSuccess::test_gate_F01_schema_migration_success PASSED [ 37%]
tests/test_phase0_gates.py::TestGateF02BackwardCompatibility::test_gate_F02_backward_compatibility PASSED [ 38%]
tests/test_phase0_gates.py::TestGateF03ApiVersioning::test_gate_F03_api_versioning PASSED [ 39%]
tests/test_phase0_gates.py::TestGateF04ConfigurationMatrix::test_gate_F04_configuration_matrix PASSED [ 40%]
tests/test_phase0_gates.py::TestGateP01MigrationLatency::test_gate_P01_migration_latency PASSED [ 41%]
tests/test_phase0_gates.py::TestGateP02QueryOverhead::test_gate_P02_query_overhead PASSED [ 43%]
tests/test_phase0_gates.py::TestGateS01DataIntegrity::test_gate_S01_data_integrity PASSED [ 44%]
tests/test_phase0_gates.py::TestGateS02RollbackSuccess::test_gate_S02_rollback_success PASSED [ 45%]
tests/test_phase0_gates.py::TestGateR01MigrationMemory::test_gate_R01_migration_memory PASSED [ 46%]
tests/test_phase0_gates.py::TestGateR02SchemaOverhead::test_gate_R02_schema_overhead PASSED [ 47%]
tests/test_phase0_gates.py::TestGateDG01PiiClassificationPolicy::test_gate_DG01_pii_classification_policy PASSED [ 48%]
tests/test_phase0_gates.py::TestGateDG02EncryptionSchema::test_gate_DG02_encryption_schema PASSED [ 50%]
tests/test_phase0_gates.py::TestGateDG03RetentionPolicy::test_gate_DG03_retention_policy PASSED [ 51%]
tests/test_phase0_gates.py::TestGateDG04AuthPlaceholder::test_gate_DG04_auth_placeholder PASSED [ 52%]
tests/test_phase0_gates.py::TestGateUQ01BufferCapacity::test_gate_UQ01_buffer_capacity PASSED [ 53%]
tests/test_phase0_gates.py::TestGateUQ02TTLCleanup::test_gate_UQ02_ttl_cleanup PASSED [ 54%]
tests/test_phase0_gates.py::TestGateUQ03FifoDeletion::test_gate_UQ03_fifo_deletion PASSED [ 55%]
tests/test_phase0_gates.py::TestGateUQ04PostUploadDeletion::test_gate_UQ04_post_upload_deletion PASSED [ 56%]
tests/test_phase0_gates.py::TestGateUQ05RetryBackoff::test_gate_UQ05_retry_backoff PASSED [ 58%]
tests/test_phase0_migration.py::TestMigrationForward::test_migration_creates_all_tables PASSED [ 59%]
tests/test_phase0_migration.py::TestMigrationForward::test_migration_idempotent PASSED [ 60%]
tests/test_phase0_migration.py::TestMigrationForward::test_migration_preserves_entries PASSED [ 61%]
tests/test_phase0_migration.py::TestMigrationForward::test_migration_performance_10k PASSED [ 62%]
tests/test_phase0_migration.py::TestMigrationForward::test_migration_memory_under_500mb PASSED [ 63%]
tests/test_phase0_migration.py::TestMigrationForward::test_schema_overhead_under_10mb PASSED [ 65%]
tests/test_phase0_migration.py::TestGovernanceColumns::test_governance_columns_exist PASSED [ 66%]
tests/test_phase0_migration.py::TestGovernanceColumns::test_encryption_columns_exist PASSED [ 67%]
tests/test_phase0_migration.py::TestGovernanceColumns::test_created_at_backfill PASSED [ 68%]
tests/test_phase0_migration.py::TestRollback::test_rollback_restores_original PASSED [ 69%]
tests/test_phase0_migration.py::TestRollback::test_rollback_preserves_entry_count PASSED [ 70%]
tests/test_phase0_migration.py::TestRollback::test_rollback_removes_governance_columns PASSED [ 72%]
tests/test_phase0_migration.py::TestRollback::test_rollback_completes_under_2min PASSED [ 73%]
tests/test_phase0_migration.py::TestIntegrity::test_data_integrity_checksum PASSED [ 74%]
tests/test_phase0_migration.py::TestIntegrity::test_checksum_deterministic PASSED [ 75%]
tests/test_phase0_models.py::TestVideoChunk::test_creation_with_defaults PASSED [ 76%]
tests/test_phase0_models.py::TestVideoChunk::test_creation_with_all_fields PASSED [ 77%]
tests/test_phase0_models.py::TestFrame::test_creation_with_required_fields PASSED [ 79%]
tests/test_phase0_models.py::TestFrame::test_creation_with_all_fields PASSED [ 80%]
tests/test_phase0_models.py::TestOcrText::test_creation PASSED           [ 81%]
tests/test_phase0_models.py::TestOcrText::test_with_optional_fields PASSED [ 82%]
tests/test_phase0_models.py::TestAudioChunk::test_creation_with_defaults PASSED [ 83%]
tests/test_phase0_models.py::TestAudioChunk::test_creation_with_all_fields PASSED [ 84%]
tests/test_phase0_models.py::TestAudioTranscription::test_nullable_speaker_id PASSED [ 86%]
tests/test_phase0_models.py::TestAudioTranscription::test_with_speaker_id PASSED [ 87%]
tests/test_phase0_models.py::TestPaginatedResponse::test_generic_with_video_chunk PASSED [ 88%]
tests/test_phase0_models.py::TestPaginatedResponse::test_has_more_false PASSED [ 89%]
tests/test_phase0_models.py::TestPaginatedResponse::test_serialization PASSED [ 90%]
tests/test_phase0_models.py::TestRecallEntryUnchanged::test_recall_entry_still_works PASSED [ 91%]
tests/test_phase0_upload_queue.py::TestCapacityEnforcement::test_capacity_enforcement_fifo PASSED [ 93%]
tests/test_phase0_upload_queue.py::TestCapacityEnforcement::test_fifo_deletion_order PASSED [ 94%]
tests/test_phase0_upload_queue.py::TestTTLCleanup::test_ttl_cleanup_7_days PASSED [ 95%]
tests/test_phase0_upload_queue.py::TestPostUploadDeletion::test_post_upload_deletion_timing PASSED [ 96%]
tests/test_phase0_upload_queue.py::TestExponentialBackoff::test_backoff_schedule PASSED [ 97%]
tests/test_phase0_upload_queue.py::TestExponentialBackoff::test_backoff_caps_at_max PASSED [ 98%]
tests/test_phase0_upload_queue.py::TestExponentialBackoff::test_consumer_uses_adr0002_backoff PASSED [100%]

============================== 86 passed in 5.42s ==============================

